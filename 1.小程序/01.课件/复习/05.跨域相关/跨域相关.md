# 跨域相关

1. 问题一:什么是跨域
   1. **违反了浏览器的同源策略**
   2. 如果当前网页的来源地址和请求地址不相同,就是跨域
      1. 协议名+域名(IP)+端口如果相同就是同源
   3. 如果两个 URL 的 **protocol(协议名)**、**port (端口号)** 和 **host(主机地址)** 都相同的话，则这两个 URL 是同源
   4. 注意:**查询字符串与同源无关,不是判断是否同源的标准**
   5. **提问:如果出现了跨域操作,浏览器为什么要报错?**
      1. **涉及到浏览器的安全策略**
      2. 如果协议名不同,还不报错,可能会导致网页通过后台访问用户本地资料,甚至将用户核心资料发送至服务器
      3. 如何主机地址不同,还不报错,会导致假网站(简称B网站),趁用户不注意,在后台通过ajax请求真实网站(简称A网站),此时浏览器会将A网站对应的Cookie发送给A网站,最终A网站身份识别成功,将用户重要数据返回给B网站,导致A网站和用户同时受损,B网站受益
2. 问题二:跨域一定会报错吗
   1. 不一定
   2. 服务器之间会出现跨域,但是不会出现跨域报错
   3. script,img,video,audio,link标签上并不会出现跨域报错
3. 问题三:什么情况下会出现跨域问题
   1. 只在浏览器中出现跨域问题
   2. 只有发送ajax请求的时候,才会出现跨域问题
   3. **总结:跨域问题其实是浏览器搞的鬼**
4. 问题四:哪些请求算是ajax请求(async javascript and xml)
   1. **通过js发送的请求就是ajax请求**
   2. **ajax不是一种特殊的请求类型,他是一种发送请求的技术**
   3. 简单说法:发送一个ajax请求
   4. 完整说法:通过ajax技术发送一个http请求
5. 跨域解决方案
   1. jsonp
      1. 原理:他通过script标签请求资源不会报跨域错误
      2. 流程:
         1. 前端准备好接受数据的函数,和准备发送请求的script标签
         2. 给script标签添加src属性,属性值是后端准备好的jsonp接口,同时将函数名传递给服务器
         3. 服务器接收到函数名,通过函数名和想要返回的数据进行拼接,得到一段文本内容
         4. 服务器将文本内容返回前端
         5. 前端script标签接收到数据,将返回的文本内容作为js解析,并立马执行
   2. CORS(跨域资源共享)
      1. 原理:跨域问题其实是浏览器搞的鬼
      2. 请求阶段是不会报错的,响应阶段才会报错
      3. 流程:
         1. 服务器在响应头中配置Access-Control-Allow-Origin:"https://www.baidu.com"
   3. proxy
   4. nginx

